# テスト環境README修正計画

## 要件定義

### 1. 修正の目的
PHPUnit機能移設（`localize-debug-log/` → `dev/`）に伴い、`dev/tests/_README.md`の内容を新しいプロジェクト構造に対応させる

### 2. 現在の問題点
`dev/tests/_README.md`の内容が移設前の構造を前提としており、以下の点で実情と乖離している：

#### 2-1. 初回セットアップ手順
- 現在：プロジェクトルートでの作業を前提とした記述
- 実際：`dev/`ディレクトリでの作業が必要

#### 2-2. 実行コマンド記載
- 現在：`composer test`コマンドのみ記載
- 実際：`npm run test`（ルートから）と`composer test`（dev/から）の2つの実行方法が利用可能

#### 2-3. 運用フローの説明
- 現在：composer前提の説明
- 実際：package.json + npm scriptsによるショートカット実行が推奨

### 3. 修正対象箇所

#### 3-1. 初回セットアップ手順セクション
- `dev/`ディレクトリでの作業を明記
- プロジェクトルートの`package.json`についての説明追加

#### 3-2. 実行コマンド一覧セクション
- npm runコマンドの追加（推奨方法として）
- 実行場所（ルート vs dev/）の明記
- PowerShell対応について補足

#### 3-3. 日常的な開発フローセクション
- ルートからの`npm run test`を推奨実行方法として追記
- `cd dev && composer test`は補助的な方法として記載

### 4. 新たに追加する内容

#### 4-1. プロジェクト構造説明
```
プロジェクトルート/
├── package.json          # npm scripts（推奨実行方法）
├── dev/                  # 開発・テスト環境
│   ├── composer.json     # PHP依存関係管理
│   ├── phpunit.xml       # テスト設定
│   └── tests/            # テストファイル群
└── localize-debug-log/   # プラグイン本体
```

#### 4-2. 実行方法の使い分け
- **推奨**: ルートから`npm run test`（ショートカット）
- **従来**: dev/から`composer test`（直接実行）

#### 4-3. PowerShell環境での注意点
- `cmd /c`使用による`&&`記号対応

### 5. 修正方針
- 既存の有用な情報（ディレクトリ構造、運用ルールなど）は維持
- 新しいプロジェクト構造に合わせて実行コマンド部分を更新
- 初心者にも分かりやすい構成で推奨実行方法を明記
- 従来の方法も残して選択肢を提供

---

## チェックボックス付き実装計画書

**実装計画立案ルール**

- 詳細なステップバイステップの計画書
- とにかく小さい単位
- 明確な開始と終了がある
- １つの関心事に集中

## 計画書

### フェーズ1: 現在のファイル内容確認
- [ ] 1-1. `dev/tests/_README.md` の現在の内容を確認する
- [ ] 1-2. 修正対象セクションの特定と現在の記述内容を把握する
- [ ] 1-3. 既存の有用な情報で維持すべき箇所をリストアップする

### フェーズ2: プロジェクト構造説明の追加
- [ ] 2-1. "## ファイル構成" セクションの前に新しいセクション "## プロジェクト全体構造" を追加する
- [ ] 2-2. 移設後の全体ディレクトリ構造図を記載する
- [ ] 2-3. 各ディレクトリの役割（ルート、dev/、localize-debug-log/）を説明する
- [ ] 2-4. package.json と composer.json の関係性を説明する

### フェーズ3: 初回セットアップ手順の修正
- [ ] 3-1. "### 新規プロジェクトでの環境構築" の1番「Composerインストール」を確認する
- [ ] 3-2. 2番「composer.json編集」の作業場所を `dev/` ディレクトリと明記する
- [ ] 3-3. 3番「PHPUnitインストール」のコマンド実行場所を `dev/` と明記する
- [ ] 3-4. 4番「ディレクトリ作成」の作業場所を `dev/tests/` と修正する
- [ ] 3-5. 5番「設定ファイル作成」の配置場所を明確化する
- [ ] 3-6. 新たに6番として「ルートpackage.json作成」の手順を追加する

### フェーズ4: 実行コマンド一覧の修正
- [ ] 4-1. "## 実行コマンド一覧" セクションのテーブルを確認する
- [ ] 4-2. 現在のテーブルの上に "### 推奨実行方法（ルートから）" セクションを追加する
- [ ] 4-3. npm run コマンドのテーブルを新規作成する
- [ ] 4-4. 既存のテーブルタイトルを "### 直接実行方法（dev/から）" に変更する
- [ ] 4-5. PowerShell環境での注意点を補足として追加する

### フェーズ5: 日常的な開発フローの修正
- [ ] 5-1. "### 🔄 日常的な開発フロー" セクションを特定する
- [ ] 5-2. 1番「通常の開発中」のコマンド例を `npm run test` に変更する
- [ ] 5-3. 従来の `composer test` は「または」として併記する
- [ ] 5-4. 3番「リリース前確認」のコマンド例を `npm run test-all` に変更する
- [ ] 5-5. 従来の `composer test-all` は「または」として併記する

### フェーズ6: Composer.jsonスクリプト設定セクションの修正
- [ ] 6-1. "## Composer.jsonスクリプト設定" セクションを特定する
- [ ] 6-2. セクションタイトルを "## スクリプト設定" に変更する
- [ ] 6-3. "### dev/composer.json" のサブセクションを追加する
- [ ] 6-4. 既存のJSONコードブロックの上に説明文を追加する
- [ ] 6-5. "### package.json（ルート）" のサブセクションを新規追加する
- [ ] 6-6. package.jsonのスクリプト設定例を追加する

### フェーズ7: 新しい運用ルールの追加
- [ ] 7-1. "## 運用ルール" セクション内に新しいサブセクション "### 💻 実行環境の選択" を追加する
- [ ] 7-2. 推奨実行方法（npm run）の利点を記載する
- [ ] 7-3. 直接実行方法（composer）を使う場面を記載する
- [ ] 7-4. 環境による違い（PowerShell対応）について説明する

### フェーズ8: トラブルシューティングの更新
- [ ] 8-1. "## トラブルシューティング" セクションを確認する
- [ ] 8-2. 新しい問題項目 "### npm run test でエラーが発生する" を追加する
- [ ] 8-3. PowerShell環境での問題と解決策を記載する
- [ ] 8-4. package.json の設定確認方法を記載する

### フェーズ9: 最終確認と整合性チェック
- [ ] 9-1. 修正した内容が要件定義と一致しているか確認する
- [ ] 9-2. 既存の有用な情報が適切に保持されているか確認する
- [ ] 9-3. 新旧の実行方法が適切に併記されているか確認する
- [ ] 9-4. 文章の流れと可読性をチェックする
- [ ] 9-5. マークダウンの記法が正しいかチェックする

---
## コミットコメント

{{実装チェックリストが完了後、ユーザーの明確な承認を得たあとでチャットに出力されたコミットコメントを記載}}
